<!-- build time:Tue Jul 22 2025 11:07:28 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="枯萎的花将在另一彼岸悄然绽放" href="https://yunhdan.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="枯萎的花将在另一彼岸悄然绽放" href="https://yunhdan.github.io/atom.xml"><link rel="alternate" type="application/json" title="枯萎的花将在另一彼岸悄然绽放" href="https://yunhdan.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://yunhdan.github.io/project/%E5%9F%BA%E4%BA%8ECLIP%E7%9A%84%E5%9B%BE%E5%83%8F%E7%89%A9%E4%BD%93%E8%BE%A8%E5%88%AB/"><title>基于CLIP的图像物体辨别 - 项目与实践 | Runfar's Zone = 枯萎的花将在另一彼岸悄然绽放</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">基于CLIP的图像物体辨别</h1><div class="meta"><span class="item" title="创建时间：2025-02-10 01:01:35"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2025-02-10T01:01:35+08:00">2025-02-10</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>32k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>29 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Runfar's Zone</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://s2.loli.net/2024/12/04/GdR2mpbCXYewZ3S.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2024/12/04/KqSM9hOFDC1uxaH.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2024/12/04/L6CFXcfKy5bNMqJ.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2025/05/18/pcPHqGALVEXJa8T.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2025/05/18/whNHCopuOyMl9Ta.jpg"></li><li class="item" data-background-image="https://s2.loli.net/2024/12/04/PfvVDlhFkxACWiS.png"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/project/" itemprop="item" rel="index" title="分类于 项目与实践"><span itemprop="name">项目与实践</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://yunhdan.github.io/project/%E5%9F%BA%E4%BA%8ECLIP%E7%9A%84%E5%9B%BE%E5%83%8F%E7%89%A9%E4%BD%93%E8%BE%A8%E5%88%AB/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/me.jpg"><meta itemprop="name" content="Runhua Deng"><meta itemprop="description" content=", 计算机视觉 & 图像恢复"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="枯萎的花将在另一彼岸悄然绽放"></span><div class="body md" itemprop="articleBody"><h1 id="基于CLIP的图像物体辨别"><a href="#基于CLIP的图像物体辨别" class="headerlink" title="基于CLIP的图像物体辨别"></a>基于<code>CLIP</code>的图像物体辨别</h1><p>:::info</p><p>具身智能依赖多模态，因此学<code>CLIP</code>是必不可少的。看了朱毅老师对<code>CLIP</code>论文的逐段精读，觉得<code>CLIP</code>这篇工作简直无愧于多模态的开山之作。于是自然而然想到做一些基于<code>CLIP</code>的实践，以表示有所学成。</p><p>:::</p><p>本实践是基于<code>CLIP</code>实现对图像内物体的分类和辨别。<code>CLIP</code>是基于对比学习的多模态模型，能够学习到文本和图像之间的联系，可以做到文本和图像的匹配。</p><h2 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h2><h4 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h4><ul><li><code>IDE</code>：我的<code>IDE</code>是<code>Pycharm 2023.3.4</code>专业版，当然用<code>Visual Studio Code</code>也行，只需要有<code>Python</code>插件即可。</li><li><code>Python</code>版本：尽量在3.8以上。</li><li>运行代码方式：在<code>Pycharm</code>中右键选择绿色的三角形和在<code>Visual Studio Code</code>中点击运行均可运行代码，但为了统一，本文选择在<code>IDE</code>的终端直接运行<code>python</code>代码。方式很简单，只要输入<code>python</code>再加上<code>py</code>文件的路径即可。</li><li>操作系统：<code>Windows</code>和<code>Linux</code>均可。</li></ul><p><img data-src="../../assets/clip2.png" alt="image"></p><h4 id="（可选）进阶"><a href="#（可选）进阶" class="headerlink" title="（可选）进阶"></a>（可选）进阶</h4><p>更推荐在<code>IDE</code>的终端切入<code>Anaconda</code>虚拟环境，选择在虚拟环境中运行<code>python</code>代码。</p><p><img data-src="../../assets/clip3.png" alt="image"></p><p>如图<code>Retinexformer_env</code>就是一个自定义的虚拟环境，这个虚拟环境中的包和<code>python</code>版本与其他虚拟环境不同。有兴趣可以了解<code>Anaconda</code>。</p><h2 id="安装相关依赖包与CLIP源"><a href="#安装相关依赖包与CLIP源" class="headerlink" title="安装相关依赖包与CLIP源"></a>安装相关依赖包与<code>CLIP</code>源</h2><p>在终端输入：</p><pre><code class="lang-powershell">pip install ftfy regex tqdm
pip install git+https://github.com/openai/CLIP.git
</code></pre><p>两行<code>pip</code>代码会在当前环境下安装<code>CLIP</code>运行的相关依赖包。</p><h2 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h2><h3 id="导入相关包"><a href="#导入相关包" class="headerlink" title="导入相关包"></a>导入相关包</h3><pre><code class="lang-python">import torch
import clip
from PIL import Image
</code></pre><h3 id="规定推理运算设备"><a href="#规定推理运算设备" class="headerlink" title="规定推理运算设备"></a>规定推理运算设备</h3><pre><code class="lang-python">device = &quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;
</code></pre><p>如果你的电脑没有<code>GPU</code>就会使用<code>CPU</code>去推理。</p><h3 id="下载模型"><a href="#下载模型" class="headerlink" title="下载模型"></a>下载模型</h3><pre><code class="lang-python">model, preprocess = clip.load(&quot;ViT-L/14&quot;, device=device)
</code></pre><p>这里使用最佳的模型：<code>ViT-L/14</code>进行推理。常见的模型还有：<code>ViT-B/32、ViT-B/16、RN50、RN101、RN50×4、RN50x16、RN50x64</code>。</p><h3 id="导入图片"><a href="#导入图片" class="headerlink" title="导入图片"></a>导入图片</h3><pre><code class="lang-python">image = preprocess(Image.open(r&quot;a-racing-car.jpg&quot;)).unsqueeze(0).to(device)
</code></pre><p>使用<code>Image</code>包导入图像，并装载到计算设备上。</p><h3 id="定义图像类别的文本并符号化"><a href="#定义图像类别的文本并符号化" class="headerlink" title="定义图像类别的文本并符号化"></a>定义图像类别的文本并符号化</h3><p>我参考了<code>ImageNet</code>中1000个类名，归纳最主要的类名以用于图像的辨别和分类。相较于实际的<code>ImageNet</code>的1000个类，辨别和分类的类别有所减少。将所有归纳好的类名标签组成一个列表，名为<code>my_text</code>。</p><p>然后，将标签进行`prompt engineering并装载到计算设备上：</p><pre><code class="lang-python">text_token = clip.tokenize(my_text).to(device)
</code></pre><h3 id="计算图像与文本的相关性"><a href="#计算图像与文本的相关性" class="headerlink" title="计算图像与文本的相关性"></a>计算图像与文本的相关性</h3><pre><code class="lang-python">logits_per_image, logits_per_text = model(image, text_token)
probs = logits_per_image.softmax(dim=-1).cpu().numpy()
</code></pre><p><code>logits_per_image</code>是对每一张图像而言的，多个文本标签与这个图像的相关性得分。<code>logits_per_text</code>则是对每个文本标签而言的，多个图像在这个文本标签的相似度。<code>probs</code>也可以理解为相关性得分，只是用<code>softmax</code>映射了一下。</p><h3 id="打印分类结果"><a href="#打印分类结果" class="headerlink" title="打印分类结果"></a>打印分类结果</h3><pre><code class="lang-python">print(&quot;A photo of &quot; + my_text[list(probs[0]).index(max(probs[0]))])
</code></pre><h3 id="核心代码-1"><a href="#核心代码-1" class="headerlink" title="核心代码"></a>核心代码</h3><pre><code class="lang-python">import torch
import clip
from PIL import Image
device = &quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;
model, preprocess = clip.load(&quot;ViT-L/14&quot;, device=device)
# ViT-B/32 or ViT-B/16 or ViT-L/14 or RN50 or RN101 or RN50x4 or RN50x16 or RN50x64
image = preprocess(Image.open(r&quot;a-racing-car.jpg&quot;)).unsqueeze(0).to(device)

my_text = [&quot;fish&quot;, &quot;cock&quot;, &quot;hen&quot;, &quot;ostrich&quot;, &quot;bird&quot;, &quot;hawk&quot;, &quot;gecko&quot;, &quot;toad&quot;, &quot;frog&quot;,
           &quot;turtle&quot;, &quot;lizard&quot;, &quot;alligator&quot;, &quot;dinosaur&quot;, &quot;snake&quot;, &quot;fossil&quot;, &quot;spider&quot;,
           &quot;centipede&quot;, &quot;peacock&quot;, &quot;duck&quot;, &quot;goose&quot;, &quot;elephant&quot;, &quot;Hedgehog&quot;, &quot;platypus&quot;, &quot;kangaroo&quot;, &quot;koala&quot;, &quot;marmot&quot;, &quot;jellyfish&quot;,
           &quot;coral&quot;, &quot;sea life&quot;, &quot;sea snake&quot;, &quot;conch&quot;, &quot;snail&quot;, &quot;crab&quot;, &quot;lobster&quot;, &quot;hermit crab&quot;, &quot;penguin&quot;, &quot;whale&quot;, &quot;walrus&quot;,
           &quot;sea lion&quot;, &quot;dog&quot;, &quot;wolf&quot;, &quot;fox&quot;, &quot;cat&quot;, &quot;leopard&quot;, &quot;lion&quot;, &quot;tiger&quot;, &quot;bear&quot;, &quot;mongoose&quot;, &quot;insects&quot;, &quot;dragonfly&quot;,
           &quot;butterfly&quot;, &quot;starfish&quot;, &quot;sea urchin&quot;, &quot;rabbit&quot;, &quot;rat&quot;, &quot;squirrel&quot;, &quot;horse&quot;, &quot;zebra&quot;, &quot;pig&quot;, &quot;hippopotamus&quot;,
           &quot;cow&quot;, &quot;sheep&quot;, &quot;camel&quot;, &quot;alpaca&quot;, &quot;raccoon&quot;, &quot;pangolin&quot;, &quot;sloth&quot;, &quot;baboon&quot;, &quot;orangutan&quot;, &quot;monkey&quot;, &quot;panda&quot;,
           &quot;abacus&quot;, &quot;muslim&quot;, &quot;bachelor&#39;s uniform&quot;, &quot;accordion&quot;, &quot;raccoon&quot;, &quot;guitar&quot;, &quot;aircraft carrier&quot;, &quot;airplane&quot;,
           &quot;airship&quot;, &quot;church&quot;, &quot;ambulance&quot;, &quot;amphibious vehicle&quot;, &quot;box&quot;, &quot;clock&quot;, &quot;apron&quot;, &quot;trash can&quot;, &quot;gun&quot;, &quot;backpack&quot;,
           &quot;Breadbox&quot;, &quot;Gymnastics&quot;, &quot;Hot Air Balloon&quot;, &quot;Pen&quot;, &quot;Bondi&quot;, &quot;Musical Instruments&quot;, &quot;Stairs&quot;, &quot;Barbells&quot;, &quot;Seats&quot;,
           &quot;Haircuts&quot;, &quot;Chalets&quot;, &quot;Tables&quot;, &quot;Wine Barrels&quot;, &quot;Trolleys&quot;, &quot;Baseball&quot;, &quot;Basketball&quot;, &quot;Baby&quot;,
           &quot;Musical Instruments&quot;, &quot;Swimming&quot;, &quot;Baby Towels&quot;, &quot;Bathtubs&quot;, &quot;cars&quot;, &quot;lighthouses&quot;, &quot;beakers&quot;, &quot;guards&quot;,
           &quot;beer&quot;, &quot;buildings&quot;, &quot;bibs&quot;, &quot;double bikes&quot;, &quot;bikinis&quot;, &quot;notebooks&quot;, &quot;telescopes&quot;, &quot;letterboxes&quot;, &quot;huts&quot;,
           &quot;sledding&quot;, &quot;necklaces&quot;, &quot;hats&quot;, &quot;bookcases&quot;, &quot;bookstores&quot;, &quot;bottle caps&quot;, &quot;bows and arrows&quot;, &quot;bow ties&quot;,
           &quot;tombstones&quot;, &quot;brassieres&quot;, &quot;armor&quot;, &quot;brooms&quot;, &quot;brooms&quot;, &quot;bucket&quot;, &quot;belt&quot;, &quot;bulletproof vest&quot;, &quot;train&quot;, &quot;butcher shop&quot;,
           &quot;taxi&quot;, &quot;pot&quot;, &quot;candle&quot;, &quot;cannon&quot;, &quot;canoe&quot;, &quot;stapler&quot;, &quot;sweater&quot;, &quot;car mirror&quot;, &quot;carousel&quot;, &quot;tool kit&quot;,
           &quot;box&quot;, &quot;car wheel&quot;, &quot;ATM&quot;, &quot;cassette&quot;, &quot;cassette player&quot;, &quot;castle&quot;, &quot;catamaran&quot;, &quot;CD player&quot;, &quot;cello&quot;,
           &quot;cell phone&quot;, &quot;chain&quot;, &quot;chainlink fence&quot;, &quot;chainsaw&quot;, &quot;chest&quot;, &quot;commode&quot;, &quot;chime&quot;, &quot;cabinet&quot;, &quot;sock&quot;,
           &quot;church&quot;, &quot;cinema&quot;, &quot;cleaver&quot;, &quot;cliff dwelling&quot;, &quot;cloak&quot;, &quot;shoe&quot;, &quot;bottle&quot;, &quot;cup&quot;, &quot;pot&quot;, &quot;coil&quot;, &quot;lock&quot;,
           &quot;keyboard&quot;, &quot;candy&quot;, &quot;ship&quot;, &quot;car&quot;, &quot;corkscrew&quot;, &quot;horn&quot;, &quot;boot&quot;, &quot;hat&quot;, &quot;crib&quot;, &quot;crane&quot;, &quot;helmet&quot;, &quot;crate&quot;,
           &quot;crib&quot;, &quot;Crock Pot&quot;, &quot;croquet ball&quot;, &quot;crutch&quot;, &quot;cuirass&quot;, &quot;dam&quot;, &quot;desk&quot;, &quot;desktop computer&quot;, &quot;dial telephone&quot;,
           &quot;diaper&quot;, &quot;digital clock&quot;, &quot;digital watch&quot;, &quot;dining table&quot;, &quot;dishcloth&quot;, &quot;dishwasher&quot;, &quot;car wheel&quot;, &quot;dock&quot;,
           &quot;dogsleigh&quot;, &quot;dome&quot;, &quot;doormat&quot;, &quot;oilfield&quot;, &quot;drum&quot;, &quot;drumstick&quot;, &quot;dumbbell&quot;, &quot;Dutch oven&quot;, &quot;electric fan&quot;,
           &quot;electric guitar&quot;, &quot;train&quot;, &quot;television&quot;, &quot;letter&quot;, &quot;coffee maker&quot;, &quot;cosmetics&quot;,&quot;feather boa&quot;, &quot;cabinet&quot;,
           &quot;fountain&quot;, &quot;fire engine&quot;, &quot;fireplace&quot;, &quot;flagpole&quot;, &quot;flute&quot;, &quot;seat&quot;, &quot;football&quot;, &quot;forklift&quot;, &quot;fountain&quot;,
           &quot;fountain pen&quot;, &quot;bed&quot;, &quot;train&quot;, &quot;French horn&quot;, &quot;frying pan&quot;, &quot;fur coat&quot;, &quot;truck&quot;, &quot;mask&quot;, &quot;gas pump&quot;,
           &quot;goblet&quot;, &quot;go-kart&quot;, &quot;golf&quot;, &quot;golf cart&quot;, &quot;boat&quot;, &quot;gong&quot;, &quot;wedding dress&quot;, &quot;piano&quot;, &quot;greenhouse&quot;, &quot;car&quot;,
           &quot;grocery store&quot;, &quot;guillotine&quot;, &quot;hair slide&quot;, &quot;hair spray&quot;, &quot;tank&quot;, &quot;hammer&quot;, &quot;bamboo tube&quot;, &quot;hair dryer&quot;,
           &quot;POS terminal&quot;, &quot;handkerchief&quot;, &quot;hard disk&quot;, &quot;harmonica&quot;, &quot;harp&quot;, &quot;crane&quot;, &quot;hatchet&quot;, &quot;pistol&quot;, &quot;television&quot;,
           &quot;honeycomb&quot;, &quot;hook&quot;, &quot;skirt&quot;, &quot;gymnastics&quot;, &quot;carriage&quot;, &quot;hourglass&quot;, &quot;music player&quot;, &quot;iron&quot;, &quot;jack-o’-lantern&quot;,
           &quot;jeans&quot;, &quot;jeep&quot;, &quot;T-shirt&quot;, &quot;jigsaw puzzle&quot;, &quot;rickshaw&quot;, &quot;joystick&quot;, &quot;kimono&quot;, &quot;knee pad&quot;, &quot;knot&quot;, &quot;lab coat&quot;,
           &quot;ladle&quot;, &quot;lamp&quot;, &quot;laptop&quot;, &quot;lawn mower&quot;, &quot;lens cap&quot;, &quot;knife&quot;, &quot;library&quot;, &quot;lifeboat&quot;, &quot;lighter&quot;, &quot;limousine&quot;,
           &quot;ship&quot;, &quot;lipstick&quot;, &quot;shoe&quot;, &quot;lotion&quot;, &quot;loudspeaker&quot;, &quot;loupe&quot;, &quot;log&quot;, &quot;compass&quot;, &quot;bag&quot;, &quot;mailbox&quot;, &quot;swimsuit&quot;,
           &quot;swimsuit&quot;, &quot;manhole cover&quot;, &quot;maraca&quot;, &quot;marimba&quot;, &quot;mask&quot;, &quot;match&quot;, &quot;rope&quot;, &quot;maze&quot;, &quot;beaker&quot;, &quot;refrigerator&quot;,
           &quot;pillar&quot;, &quot;microphone&quot;, &quot;microwave&quot;, &quot;military uniform&quot;, &quot;water jug&quot;, &quot;minibus&quot;, &quot;miniskirt&quot;, &quot;minivan&quot;, &quot;missile&quot;,
           &quot;gloves&quot;, &quot;bowl&quot;, &quot;motor home&quot;, &quot;vintage car&quot;, &quot;router&quot;, &quot;building&quot;, &quot;monitor&quot;, &quot;motorcycle&quot;, &quot;inkstone&quot;, &quot;mortarboard&quot;,
           &quot;building&quot;, &quot;mosquito net&quot;, &quot;scooter&quot;, &quot;bicycle&quot;, &quot;tent&quot;, &quot;keyboard and mouse&quot;, &quot;mousetrap&quot;, &quot;truck&quot;, &quot;muzzle&quot;,
           &quot;nail&quot;, &quot;neck brace&quot;, &quot;necklace&quot;, &quot;baby bottle&quot;, &quot;notebook&quot;, &quot;building&quot;, &quot;clarinet&quot;, &quot;ocarina&quot;, &quot;dashboard&quot;,
           &quot;oil filter&quot;, &quot;organ&quot;, &quot;oscilloscope&quot;, &quot;dress&quot;, &quot;oxcart&quot;, &quot;respirator&quot;, &quot;snack&quot;, &quot;paddle&quot;, &quot;paddle wheel&quot;,
           &quot;padlock&quot;, &quot;brush&quot;, &quot;pajamas&quot;, &quot;building&quot;, &quot;musical instrument&quot;, &quot;paper towel&quot;, &quot;parachute&quot;, &quot;parallel bars&quot;,
           &quot;bench&quot;, &quot;parking meter&quot;, &quot;train&quot;, &quot;yard&quot;, &quot;payphone&quot;, &quot;pillar&quot;, &quot;pencil box&quot;, &quot;pencil sharpener&quot;, &quot;perfume&quot;,
           &quot;Petri dish&quot;, &quot;printer&quot;, &quot;pick&quot;, &quot;helmet&quot;, &quot;fence&quot;, &quot;car&quot;, &quot;bridge&quot;, &quot;piggy bank&quot;, &quot;pill&quot;, &quot;pillow&quot;, &quot;ping-pong ball&quot;,
           &quot;pinwheel&quot;, &quot;sailboat&quot;, &quot;teapot&quot;, &quot;plane&quot;, &quot;building&quot;, &quot;plastic bag&quot;, &quot;plate rack&quot;, &quot;bulldozer&quot;, &quot;plunger&quot;,
           &quot;camera&quot;, &quot;pole&quot;, &quot;police car&quot;, &quot;poncho&quot;, &quot;pool table&quot;, &quot;bottle&quot;, &quot;potted plant&quot;, &quot;pottery&quot;, &quot;drill&quot;, &quot;blanket&quot;,
           &quot;printer&quot;, &quot;prison&quot;, &quot;missile&quot;, &quot;projector&quot;, &quot;puck&quot;, &quot;punching bag&quot;, &quot;handbag&quot;, &quot;quill pen&quot;, &quot;bed&quot;, &quot;racing car&quot;,
           &quot;tennis&quot;, &quot;heater&quot;, &quot;radio&quot;, &quot;satellite receiver&quot;, &quot;wine barrel&quot;, &quot;mobile home&quot;, &quot;fishing rod&quot;, &quot;camera&quot;, &quot;refrigerator&quot;,
           &quot;remote control&quot;, &quot;restaurant&quot;, &quot;pistol&quot;, &quot;sniper rifle&quot;, &quot;rocking chair&quot;, &quot;oven&quot;, &quot;eraser&quot;, &quot;rugby ball&quot;, &quot;ruler&quot;,
           &quot;running shoes&quot;, &quot;safe&quot;, &quot;paperclip&quot;, &quot;salt shaker&quot;, &quot;slippers&quot;, &quot;long skirt&quot;, &quot;saxophone&quot;, &quot;sword&quot;, &quot;scale&quot;,
           &quot;school bus&quot;, &quot;sailboat&quot;, &quot;scoreboard&quot;, &quot;monitor&quot;, &quot;screw&quot;, &quot;screwdriver&quot;, &quot;seatbelt&quot;, &quot;sewing machine&quot;,
           &quot;shield&quot;, &quot;shoe store&quot;, &quot;tatami&quot;, &quot;shopping basket&quot;, &quot;shopping cart&quot;, &quot;shovel&quot;, &quot;shower cap&quot;, &quot;shower curtain&quot;,
           &quot;skiing&quot;, &quot;ski mask&quot;, &quot;sleeping bag&quot;, &quot;slide caliper&quot;, &quot;sliding door&quot;, &quot;slot machine&quot;, &quot;swimming goggles&quot;, &quot;snowmobile&quot;,
           &quot;snowplow&quot;, &quot;soap dispenser&quot;, &quot;soccer ball&quot;, &quot;socks&quot;, &quot;solar panel&quot;, &quot;hat&quot;, &quot;bowl&quot;, &quot;keyboard&quot;, &quot;space heater&quot;,
           &quot;space shuttle&quot;, &quot;spatula&quot;, &quot;speedboat&quot;, &quot;spider web&quot;, &quot;yarn&quot;, &quot;sports car&quot;, &quot;spotlight&quot;, &quot;band&quot;, &quot;steam locomotive&quot;,
           &quot;bridge&quot;, &quot;drum&quot;, &quot;stethoscope&quot;, &quot;stretcher&quot;, &quot;stone pile&quot;, &quot;stopwatch&quot;, &quot;stove&quot;, &quot;strainer&quot;, &quot;streetcar&quot;, &quot;stretcher&quot;,
           &quot;sofa&quot;, &quot;palace&quot;, &quot;ship&quot;, &quot;suit&quot;, &quot;sundial&quot;, &quot;sunglasses&quot;, &quot;sunglasses&quot;, &quot;sunscreen&quot;, &quot;bridge&quot;, &quot;mop&quot;, &quot;hoodie&quot;,
           &quot;swimming trunks&quot;, &quot;swing&quot;, &quot;switch&quot;, &quot;syringe&quot;, &quot;table lamp&quot;, &quot;tank&quot;, &quot;tape player&quot;, &quot;teapot&quot;, &quot;teddy bear&quot;,
           &quot;television&quot;, &quot;tennis ball&quot;, &quot;thatch&quot;, &quot;theater curtain&quot;, &quot;thimble&quot;, &quot;armored vehicle&quot;, &quot;throne&quot;, &quot;tile&quot;, &quot;toaster&quot;,
           &quot;tobacco shop&quot;, &quot;toilet&quot;, &quot;torch&quot;, &quot;totem pole&quot;, &quot;tow truck&quot;, &quot;toy store&quot;, &quot;tractor&quot;, &quot;trailer truck&quot;, &quot;plate&quot;,
           &quot;trench coat&quot;, &quot;tricycle&quot;, &quot;boat&quot;, &quot;tripod&quot;, &quot;arch&quot;, &quot;bus&quot;, &quot;trombone&quot;, &quot;bathtub&quot;, &quot;turnstile&quot;, &quot;typewriter&quot;,
           &quot;umbrella&quot;, &quot;unicycle&quot;, &quot;piano&quot;, &quot;vacuum cleaner&quot;, &quot;vase&quot;, &quot;vault&quot;, &quot;velvet&quot;, &quot;vending machine&quot;, &quot;vestment&quot;,
           &quot;bridge&quot;, &quot;violin&quot;, &quot;volleyball&quot;, &quot;waffle iron&quot;, &quot;wall clock&quot;, &quot;wallet&quot;, &quot;wardrobe&quot;, &quot;airplane&quot;, &quot;washbasin&quot;,
           &quot;washing machine&quot;, &quot;water bottle&quot;, &quot;water jug&quot;, &quot;water tower&quot;, &quot;water jug&quot;, &quot;whistle&quot;, &quot;wig&quot;, &quot;window&quot;, &quot;window shade&quot;,
           &quot;tie&quot;, &quot;wine&quot;, &quot;airplane&quot;, &quot;wok&quot;, &quot;spoon&quot;, &quot;scarf&quot;, &quot;fence&quot;, &quot;wreck&quot;, &quot;sailboat&quot;, &quot;yurt&quot;, &quot;website&quot;, &quot;poster&quot;,
           &quot;crossword puzzle&quot;, &quot;traffic sign&quot;, &quot;traffic light&quot;, &quot;book&quot;, &quot;menu&quot;, &quot;dish&quot;, &quot;cake&quot;, &quot;ice cream&quot;, &quot;popsicle&quot;,
           &quot;bread&quot;, &quot;doughnut&quot;, &quot;bread&quot;, &quot;hamburger&quot;, &quot;hot dog&quot;, &quot;mashed potato&quot;, &quot;vegetable&quot;, &quot;broccoli&quot;, &quot;cauliflower&quot;,
           &quot;vegetable&quot;, &quot;spaghetti squash&quot;, &quot;pumpkin&quot;, &quot;cucumber&quot;, &quot;vegetable&quot;, &quot;bell pepper&quot;, &quot;flower&quot;, &quot;mushroom&quot;,
           &quot;apple&quot;, &quot;strawberry&quot;, &quot;orange&quot;, &quot;lemon&quot;, &quot;fruit&quot;, &quot;pineapple&quot;, &quot;banana&quot;, &quot;durian&quot;, &quot;fruit&quot;, &quot;pomegranate&quot;,
           &quot;alp&quot;, &quot;bubble&quot;, &quot;cliff&quot;, &quot;coral&quot;, &quot;hot spring&quot;, &quot;scenery&quot;, &quot;island&quot;, &quot;beach&quot;, &quot;seashore&quot;, &quot;waterfall&quot;, &quot;volcano&quot;,
           &quot;wedding&quot;, &quot;diving&quot;, &quot;rapeseed&quot;, &quot;daisy&quot;, &quot;plant&quot;, &quot;corn&quot;, &quot;pinecone&quot;, &quot;chestnut&quot;, &quot;mushroom&quot;, &quot;corn&quot;, &quot;toilet paper&quot;,
           &quot;woman&quot;, &quot;man&quot;
] # 类名

your_idea_text = &quot;a car&quot;     # 你对这张图片的辨别。
my_text.append(your_idea_text)

text_token = clip.tokenize(my_text).to(device)
with torch.no_grad():
    image_features = model.encode_image(image)
    text_features = model.encode_text(text_token)

    logits_per_image, logits_per_text = model(image, text_token)
    probs = logits_per_image.softmax(dim=-1).cpu().numpy()

print(&quot;A photo of &quot; + my_text[list(probs[0]).index(max(probs[0]))])
</code></pre><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p>以这张图片为例：</p><p><img data-src="../../assets/clip6.jpg" alt="image"></p><p>运行代码后，识别出的图片内容：</p><p><img data-src="../../assets/clip5.png" alt="image"></p><h2 id="探索代码"><a href="#探索代码" class="headerlink" title="探索代码"></a>探索代码</h2><p>可以发现总代码的<code>image_features</code>和<code>text_features</code>并没有用上。其实，<code>image_features</code>是所有图像特征的集合，<code>text_features</code>是所有文本标签的特征集合。可以用<code>PCA</code>主成分分析法可视化出来。为了简便，删除大部分<code>my_text</code>文本标签，只保留若干个标签。</p><pre><code class="lang-python">my_text = [&quot;fish&quot;, &quot;cock&quot;, &quot;hen&quot;, &quot;ostrich&quot;, &quot;bird&quot;, &quot;hawk&quot;, &quot;gecko&quot;, &quot;toad&quot;, &quot;frog&quot;]
</code></pre><p>依然，你的猜测是：</p><pre><code class="lang-python">your_idea_text = &quot;a car&quot;     # 你对这张图片的辨别。
</code></pre><p>导入相关包：</p><pre><code class="lang-python">from sklearn.decomposition import PCA
import matplotlib.pyplot as plt
</code></pre><p>先将图像特征和文本特征拼接到一起方便处理：</p><pre><code class="lang-python">all_features = torch.cat([image_features, text_features], dim=0).cpu().numpy()
</code></pre><p>建立模型，处理图像特征和文本特征，将高维特征映射到二维平面特征：</p><pre><code class="lang-python">pca = PCA(n_components=2)
features_2d = pca.fit_transform(all_features)
</code></pre><p>可视化，首先将图像的特征打点：</p><pre><code class="lang-python">plt.figure(figsize=(10, 10))
plt.scatter(features_2d[0, 0], features_2d[0, 1], color=&#39;red&#39;, label=&#39;Image Feature&#39;)
</code></pre><p>接下来打点文本特征：</p><pre><code class="lang-python">for i, text in enumerate(my_text):
    plt.scatter(features_2d[i+1, 0], features_2d[i+1, 1], label=f&#39;Text Feature: &#123;text&#125;&#39;)
</code></pre><p>显示图例，横纵轴标签等，并最终显示：</p><pre><code class="lang-python">plt.legend()
plt.title(&quot;PCA of Image and Text Features&quot;)
plt.xlabel(&quot;PCA Component 1&quot;)
plt.ylabel(&quot;PCA Component 2&quot;)
plt.show()
</code></pre><p>可视化图像为：</p><p><img data-src="../../assets/clip7.png" alt="image"></p><p>我们丰富一下猜测的文本：</p><pre><code class="lang-python">your_idea_text = &quot;a racing car with road-blocks&quot;     # 你对这张图片的识别。
</code></pre><p>可视化出来可以看到猜测的文本特征与图像特征更接近了：<br><img data-src="../../assets/clip8.png" alt="image"></p><p>更进一步的丰富，加上了路障的颜色以及车子在地上的描述：</p><pre><code class="lang-python">your_idea_text = &quot;a racing car on the floor with some red and blue road-blocks besides&quot;     # 你对这张图片的识别。
</code></pre><p>可视化出来，可见猜测的文本在横轴的数值在这次的修改超过了5，进一步向图像特征接近：</p><p><img data-src="../../assets/clip9.png" alt="image"></p><p>[这也就说明，跨模态的信息可以被统一地映射到同一个特征空间进行学习，这就为多模态的研究开辟了道路]{.red}</p><h2 id="总代码"><a href="#总代码" class="headerlink" title="总代码"></a>总代码</h2><pre><code class="lang-python">import numpy as np
import torch
import clip
from PIL import Image
device = &quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;
model, preprocess = clip.load(&quot;ViT-L/14&quot;, device=device)
# ViT-B/32 or ViT-B/16 or ViT-L/14 or RN50 or RN101 or RN50x4 or RN50x16 or RN50x64
image = preprocess(Image.open(r&quot;a-racing-car.jpg&quot;)).unsqueeze(0).to(device)

my_text = [&quot;fish&quot;, &quot;cock&quot;, &quot;hen&quot;, &quot;ostrich&quot;, &quot;bird&quot;, &quot;hawk&quot;, &quot;gecko&quot;, &quot;toad&quot;, &quot;frog&quot;,
           &quot;turtle&quot;, &quot;lizard&quot;, &quot;alligator&quot;, &quot;dinosaur&quot;, &quot;snake&quot;, &quot;fossil&quot;, &quot;spider&quot;,
           &quot;centipede&quot;, &quot;peacock&quot;, &quot;duck&quot;, &quot;goose&quot;, &quot;elephant&quot;, &quot;Hedgehog&quot;, &quot;platypus&quot;, &quot;kangaroo&quot;, &quot;koala&quot;, &quot;marmot&quot;, &quot;jellyfish&quot;,
           &quot;coral&quot;, &quot;sea life&quot;, &quot;sea snake&quot;, &quot;conch&quot;, &quot;snail&quot;, &quot;crab&quot;, &quot;lobster&quot;, &quot;hermit crab&quot;, &quot;penguin&quot;, &quot;whale&quot;, &quot;walrus&quot;,
           &quot;sea lion&quot;, &quot;dog&quot;, &quot;wolf&quot;, &quot;fox&quot;, &quot;cat&quot;, &quot;leopard&quot;, &quot;lion&quot;, &quot;tiger&quot;, &quot;bear&quot;, &quot;mongoose&quot;, &quot;insects&quot;, &quot;dragonfly&quot;,
           &quot;butterfly&quot;, &quot;starfish&quot;, &quot;sea urchin&quot;, &quot;rabbit&quot;, &quot;rat&quot;, &quot;squirrel&quot;, &quot;horse&quot;, &quot;zebra&quot;, &quot;pig&quot;, &quot;hippopotamus&quot;,
           &quot;cow&quot;, &quot;sheep&quot;, &quot;camel&quot;, &quot;alpaca&quot;, &quot;raccoon&quot;, &quot;pangolin&quot;, &quot;sloth&quot;, &quot;baboon&quot;, &quot;orangutan&quot;, &quot;monkey&quot;, &quot;panda&quot;,
           &quot;abacus&quot;, &quot;muslim&quot;, &quot;bachelor&#39;s uniform&quot;, &quot;accordion&quot;, &quot;raccoon&quot;, &quot;guitar&quot;, &quot;aircraft carrier&quot;, &quot;airplane&quot;,
           &quot;airship&quot;, &quot;church&quot;, &quot;ambulance&quot;, &quot;amphibious vehicle&quot;, &quot;box&quot;, &quot;clock&quot;, &quot;apron&quot;, &quot;trash can&quot;, &quot;gun&quot;, &quot;backpack&quot;,
           &quot;Breadbox&quot;, &quot;Gymnastics&quot;, &quot;Hot Air Balloon&quot;, &quot;Pen&quot;, &quot;Bondi&quot;, &quot;Musical Instruments&quot;, &quot;Stairs&quot;, &quot;Barbells&quot;, &quot;Seats&quot;,
           &quot;Haircuts&quot;, &quot;Chalets&quot;, &quot;Tables&quot;, &quot;Wine Barrels&quot;, &quot;Trolleys&quot;, &quot;Baseball&quot;, &quot;Basketball&quot;, &quot;Baby&quot;,
           &quot;Musical Instruments&quot;, &quot;Swimming&quot;, &quot;Baby Towels&quot;, &quot;Bathtubs&quot;, &quot;cars&quot;, &quot;lighthouses&quot;, &quot;beakers&quot;, &quot;guards&quot;,
           &quot;beer&quot;, &quot;buildings&quot;, &quot;bibs&quot;, &quot;double bikes&quot;, &quot;bikinis&quot;, &quot;notebooks&quot;, &quot;telescopes&quot;, &quot;letterboxes&quot;, &quot;huts&quot;,
           &quot;sledding&quot;, &quot;necklaces&quot;, &quot;hats&quot;, &quot;bookcases&quot;, &quot;bookstores&quot;, &quot;bottle caps&quot;, &quot;bows and arrows&quot;, &quot;bow ties&quot;,
           &quot;tombstones&quot;, &quot;brassieres&quot;, &quot;armor&quot;, &quot;brooms&quot;, &quot;brooms&quot;, &quot;bucket&quot;, &quot;belt&quot;, &quot;bulletproof vest&quot;, &quot;train&quot;, &quot;butcher shop&quot;,
           &quot;taxi&quot;, &quot;pot&quot;, &quot;candle&quot;, &quot;cannon&quot;, &quot;canoe&quot;, &quot;stapler&quot;, &quot;sweater&quot;, &quot;car mirror&quot;, &quot;carousel&quot;, &quot;tool kit&quot;,
           &quot;box&quot;, &quot;car wheel&quot;, &quot;ATM&quot;, &quot;cassette&quot;, &quot;cassette player&quot;, &quot;castle&quot;, &quot;catamaran&quot;, &quot;CD player&quot;, &quot;cello&quot;,
           &quot;cell phone&quot;, &quot;chain&quot;, &quot;chainlink fence&quot;, &quot;chainsaw&quot;, &quot;chest&quot;, &quot;commode&quot;, &quot;chime&quot;, &quot;cabinet&quot;, &quot;sock&quot;,
           &quot;church&quot;, &quot;cinema&quot;, &quot;cleaver&quot;, &quot;cliff dwelling&quot;, &quot;cloak&quot;, &quot;shoe&quot;, &quot;bottle&quot;, &quot;cup&quot;, &quot;pot&quot;, &quot;coil&quot;, &quot;lock&quot;,
           &quot;keyboard&quot;, &quot;candy&quot;, &quot;ship&quot;, &quot;car&quot;, &quot;corkscrew&quot;, &quot;horn&quot;, &quot;boot&quot;, &quot;hat&quot;, &quot;crib&quot;, &quot;crane&quot;, &quot;helmet&quot;, &quot;crate&quot;,
           &quot;crib&quot;, &quot;Crock Pot&quot;, &quot;croquet ball&quot;, &quot;crutch&quot;, &quot;cuirass&quot;, &quot;dam&quot;, &quot;desk&quot;, &quot;desktop computer&quot;, &quot;dial telephone&quot;,
           &quot;diaper&quot;, &quot;digital clock&quot;, &quot;digital watch&quot;, &quot;dining table&quot;, &quot;dishcloth&quot;, &quot;dishwasher&quot;, &quot;car wheel&quot;, &quot;dock&quot;,
           &quot;dogsleigh&quot;, &quot;dome&quot;, &quot;doormat&quot;, &quot;oilfield&quot;, &quot;drum&quot;, &quot;drumstick&quot;, &quot;dumbbell&quot;, &quot;Dutch oven&quot;, &quot;electric fan&quot;,
           &quot;electric guitar&quot;, &quot;train&quot;, &quot;television&quot;, &quot;letter&quot;, &quot;coffee maker&quot;, &quot;cosmetics&quot;,&quot;feather boa&quot;, &quot;cabinet&quot;,
           &quot;fountain&quot;, &quot;fire engine&quot;, &quot;fireplace&quot;, &quot;flagpole&quot;, &quot;flute&quot;, &quot;seat&quot;, &quot;football&quot;, &quot;forklift&quot;, &quot;fountain&quot;,
           &quot;fountain pen&quot;, &quot;bed&quot;, &quot;train&quot;, &quot;French horn&quot;, &quot;frying pan&quot;, &quot;fur coat&quot;, &quot;truck&quot;, &quot;mask&quot;, &quot;gas pump&quot;,
           &quot;goblet&quot;, &quot;go-kart&quot;, &quot;golf&quot;, &quot;golf cart&quot;, &quot;boat&quot;, &quot;gong&quot;, &quot;wedding dress&quot;, &quot;piano&quot;, &quot;greenhouse&quot;, &quot;car&quot;,
           &quot;grocery store&quot;, &quot;guillotine&quot;, &quot;hair slide&quot;, &quot;hair spray&quot;, &quot;tank&quot;, &quot;hammer&quot;, &quot;bamboo tube&quot;, &quot;hair dryer&quot;,
           &quot;POS terminal&quot;, &quot;handkerchief&quot;, &quot;hard disk&quot;, &quot;harmonica&quot;, &quot;harp&quot;, &quot;crane&quot;, &quot;hatchet&quot;, &quot;pistol&quot;, &quot;television&quot;,
           &quot;honeycomb&quot;, &quot;hook&quot;, &quot;skirt&quot;, &quot;gymnastics&quot;, &quot;carriage&quot;, &quot;hourglass&quot;, &quot;music player&quot;, &quot;iron&quot;, &quot;jack-o’-lantern&quot;,
           &quot;jeans&quot;, &quot;jeep&quot;, &quot;T-shirt&quot;, &quot;jigsaw puzzle&quot;, &quot;rickshaw&quot;, &quot;joystick&quot;, &quot;kimono&quot;, &quot;knee pad&quot;, &quot;knot&quot;, &quot;lab coat&quot;,
           &quot;ladle&quot;, &quot;lamp&quot;, &quot;laptop&quot;, &quot;lawn mower&quot;, &quot;lens cap&quot;, &quot;knife&quot;, &quot;library&quot;, &quot;lifeboat&quot;, &quot;lighter&quot;, &quot;limousine&quot;,
           &quot;ship&quot;, &quot;lipstick&quot;, &quot;shoe&quot;, &quot;lotion&quot;, &quot;loudspeaker&quot;, &quot;loupe&quot;, &quot;log&quot;, &quot;compass&quot;, &quot;bag&quot;, &quot;mailbox&quot;, &quot;swimsuit&quot;,
           &quot;swimsuit&quot;, &quot;manhole cover&quot;, &quot;maraca&quot;, &quot;marimba&quot;, &quot;mask&quot;, &quot;match&quot;, &quot;rope&quot;, &quot;maze&quot;, &quot;beaker&quot;, &quot;refrigerator&quot;,
           &quot;pillar&quot;, &quot;microphone&quot;, &quot;microwave&quot;, &quot;military uniform&quot;, &quot;water jug&quot;, &quot;minibus&quot;, &quot;miniskirt&quot;, &quot;minivan&quot;, &quot;missile&quot;,
           &quot;gloves&quot;, &quot;bowl&quot;, &quot;motor home&quot;, &quot;vintage car&quot;, &quot;router&quot;, &quot;building&quot;, &quot;monitor&quot;, &quot;motorcycle&quot;, &quot;inkstone&quot;, &quot;mortarboard&quot;,
           &quot;building&quot;, &quot;mosquito net&quot;, &quot;scooter&quot;, &quot;bicycle&quot;, &quot;tent&quot;, &quot;keyboard and mouse&quot;, &quot;mousetrap&quot;, &quot;truck&quot;, &quot;muzzle&quot;,
           &quot;nail&quot;, &quot;neck brace&quot;, &quot;necklace&quot;, &quot;baby bottle&quot;, &quot;notebook&quot;, &quot;building&quot;, &quot;clarinet&quot;, &quot;ocarina&quot;, &quot;dashboard&quot;,
           &quot;oil filter&quot;, &quot;organ&quot;, &quot;oscilloscope&quot;, &quot;dress&quot;, &quot;oxcart&quot;, &quot;respirator&quot;, &quot;snack&quot;, &quot;paddle&quot;, &quot;paddle wheel&quot;,
           &quot;padlock&quot;, &quot;brush&quot;, &quot;pajamas&quot;, &quot;building&quot;, &quot;musical instrument&quot;, &quot;paper towel&quot;, &quot;parachute&quot;, &quot;parallel bars&quot;,
           &quot;bench&quot;, &quot;parking meter&quot;, &quot;train&quot;, &quot;yard&quot;, &quot;payphone&quot;, &quot;pillar&quot;, &quot;pencil box&quot;, &quot;pencil sharpener&quot;, &quot;perfume&quot;,
           &quot;Petri dish&quot;, &quot;printer&quot;, &quot;pick&quot;, &quot;helmet&quot;, &quot;fence&quot;, &quot;car&quot;, &quot;bridge&quot;, &quot;piggy bank&quot;, &quot;pill&quot;, &quot;pillow&quot;, &quot;ping-pong ball&quot;,
           &quot;pinwheel&quot;, &quot;sailboat&quot;, &quot;teapot&quot;, &quot;plane&quot;, &quot;building&quot;, &quot;plastic bag&quot;, &quot;plate rack&quot;, &quot;bulldozer&quot;, &quot;plunger&quot;,
           &quot;camera&quot;, &quot;pole&quot;, &quot;police car&quot;, &quot;poncho&quot;, &quot;pool table&quot;, &quot;bottle&quot;, &quot;potted plant&quot;, &quot;pottery&quot;, &quot;drill&quot;, &quot;blanket&quot;,
           &quot;printer&quot;, &quot;prison&quot;, &quot;missile&quot;, &quot;projector&quot;, &quot;puck&quot;, &quot;punching bag&quot;, &quot;handbag&quot;, &quot;quill pen&quot;, &quot;bed&quot;, &quot;racing car&quot;,
           &quot;tennis&quot;, &quot;heater&quot;, &quot;radio&quot;, &quot;satellite receiver&quot;, &quot;wine barrel&quot;, &quot;mobile home&quot;, &quot;fishing rod&quot;, &quot;camera&quot;, &quot;refrigerator&quot;,
           &quot;remote control&quot;, &quot;restaurant&quot;, &quot;pistol&quot;, &quot;sniper rifle&quot;, &quot;rocking chair&quot;, &quot;oven&quot;, &quot;eraser&quot;, &quot;rugby ball&quot;, &quot;ruler&quot;,
           &quot;running shoes&quot;, &quot;safe&quot;, &quot;paperclip&quot;, &quot;salt shaker&quot;, &quot;slippers&quot;, &quot;long skirt&quot;, &quot;saxophone&quot;, &quot;sword&quot;, &quot;scale&quot;,
           &quot;school bus&quot;, &quot;sailboat&quot;, &quot;scoreboard&quot;, &quot;monitor&quot;, &quot;screw&quot;, &quot;screwdriver&quot;, &quot;seatbelt&quot;, &quot;sewing machine&quot;,
           &quot;shield&quot;, &quot;shoe store&quot;, &quot;tatami&quot;, &quot;shopping basket&quot;, &quot;shopping cart&quot;, &quot;shovel&quot;, &quot;shower cap&quot;, &quot;shower curtain&quot;,
           &quot;skiing&quot;, &quot;ski mask&quot;, &quot;sleeping bag&quot;, &quot;slide caliper&quot;, &quot;sliding door&quot;, &quot;slot machine&quot;, &quot;swimming goggles&quot;, &quot;snowmobile&quot;,
           &quot;snowplow&quot;, &quot;soap dispenser&quot;, &quot;soccer ball&quot;, &quot;socks&quot;, &quot;solar panel&quot;, &quot;hat&quot;, &quot;bowl&quot;, &quot;keyboard&quot;, &quot;space heater&quot;,
           &quot;space shuttle&quot;, &quot;spatula&quot;, &quot;speedboat&quot;, &quot;spider web&quot;, &quot;yarn&quot;, &quot;sports car&quot;, &quot;spotlight&quot;, &quot;band&quot;, &quot;steam locomotive&quot;,
           &quot;bridge&quot;, &quot;drum&quot;, &quot;stethoscope&quot;, &quot;stretcher&quot;, &quot;stone pile&quot;, &quot;stopwatch&quot;, &quot;stove&quot;, &quot;strainer&quot;, &quot;streetcar&quot;, &quot;stretcher&quot;,
           &quot;sofa&quot;, &quot;palace&quot;, &quot;ship&quot;, &quot;suit&quot;, &quot;sundial&quot;, &quot;sunglasses&quot;, &quot;sunglasses&quot;, &quot;sunscreen&quot;, &quot;bridge&quot;, &quot;mop&quot;, &quot;hoodie&quot;,
           &quot;swimming trunks&quot;, &quot;swing&quot;, &quot;switch&quot;, &quot;syringe&quot;, &quot;table lamp&quot;, &quot;tank&quot;, &quot;tape player&quot;, &quot;teapot&quot;, &quot;teddy bear&quot;,
           &quot;television&quot;, &quot;tennis ball&quot;, &quot;thatch&quot;, &quot;theater curtain&quot;, &quot;thimble&quot;, &quot;armored vehicle&quot;, &quot;throne&quot;, &quot;tile&quot;, &quot;toaster&quot;,
           &quot;tobacco shop&quot;, &quot;toilet&quot;, &quot;torch&quot;, &quot;totem pole&quot;, &quot;tow truck&quot;, &quot;toy store&quot;, &quot;tractor&quot;, &quot;trailer truck&quot;, &quot;plate&quot;,
           &quot;trench coat&quot;, &quot;tricycle&quot;, &quot;boat&quot;, &quot;tripod&quot;, &quot;arch&quot;, &quot;bus&quot;, &quot;trombone&quot;, &quot;bathtub&quot;, &quot;turnstile&quot;, &quot;typewriter&quot;,
           &quot;umbrella&quot;, &quot;unicycle&quot;, &quot;piano&quot;, &quot;vacuum cleaner&quot;, &quot;vase&quot;, &quot;vault&quot;, &quot;velvet&quot;, &quot;vending machine&quot;, &quot;vestment&quot;,
           &quot;bridge&quot;, &quot;violin&quot;, &quot;volleyball&quot;, &quot;waffle iron&quot;, &quot;wall clock&quot;, &quot;wallet&quot;, &quot;wardrobe&quot;, &quot;airplane&quot;, &quot;washbasin&quot;,
           &quot;washing machine&quot;, &quot;water bottle&quot;, &quot;water jug&quot;, &quot;water tower&quot;, &quot;water jug&quot;, &quot;whistle&quot;, &quot;wig&quot;, &quot;window&quot;, &quot;window shade&quot;,
           &quot;tie&quot;, &quot;wine&quot;, &quot;airplane&quot;, &quot;wok&quot;, &quot;spoon&quot;, &quot;scarf&quot;, &quot;fence&quot;, &quot;wreck&quot;, &quot;sailboat&quot;, &quot;yurt&quot;, &quot;website&quot;, &quot;poster&quot;,
           &quot;crossword puzzle&quot;, &quot;traffic sign&quot;, &quot;traffic light&quot;, &quot;book&quot;, &quot;menu&quot;, &quot;dish&quot;, &quot;cake&quot;, &quot;ice cream&quot;, &quot;popsicle&quot;,
           &quot;bread&quot;, &quot;doughnut&quot;, &quot;bread&quot;, &quot;hamburger&quot;, &quot;hot dog&quot;, &quot;mashed potato&quot;, &quot;vegetable&quot;, &quot;broccoli&quot;, &quot;cauliflower&quot;,
           &quot;vegetable&quot;, &quot;spaghetti squash&quot;, &quot;pumpkin&quot;, &quot;cucumber&quot;, &quot;vegetable&quot;, &quot;bell pepper&quot;, &quot;flower&quot;, &quot;mushroom&quot;,
           &quot;apple&quot;, &quot;strawberry&quot;, &quot;orange&quot;, &quot;lemon&quot;, &quot;fruit&quot;, &quot;pineapple&quot;, &quot;banana&quot;, &quot;durian&quot;, &quot;fruit&quot;, &quot;pomegranate&quot;,
           &quot;alp&quot;, &quot;bubble&quot;, &quot;cliff&quot;, &quot;coral&quot;, &quot;hot spring&quot;, &quot;scenery&quot;, &quot;island&quot;, &quot;beach&quot;, &quot;seashore&quot;, &quot;waterfall&quot;, &quot;volcano&quot;,
           &quot;wedding&quot;, &quot;diving&quot;, &quot;rapeseed&quot;, &quot;daisy&quot;, &quot;plant&quot;, &quot;corn&quot;, &quot;pinecone&quot;, &quot;chestnut&quot;, &quot;mushroom&quot;, &quot;corn&quot;, &quot;toilet paper&quot;,
           &quot;woman&quot;, &quot;man&quot;
]

# your_idea_text = &quot;a racing car on the floor with some red and blue road-blocks besides&quot;     # 你对这张图片的识别。
# your_idea_text = &quot;a racing car with road-blocks&quot;     # 你对这张图片的识别。
your_idea_text = &quot;a car &quot;     # 你对这张图片的识别。
my_text.append(your_idea_text)

text_token = clip.tokenize(my_text).to(device)
with torch.no_grad():
    image_features = model.encode_image(image)
    text_features = model.encode_text(text_token)

    logits_per_image, logits_per_text = model(image, text_token)
    probs = logits_per_image.softmax(dim=-1).cpu().numpy()

print(&quot;A photo of &quot; + my_text[list(probs[0]).index(max(probs[0]))])

from sklearn.decomposition import PCA
import matplotlib.pyplot as plt

all_features = torch.cat([image_features, text_features], dim=0).cpu().numpy()

pca = PCA(n_components=2)
features_2d = pca.fit_transform(all_features)

plt.figure(figsize=(10, 10))
plt.scatter(features_2d[0, 0], features_2d[0, 1], color=&#39;red&#39;, label=&#39;Image Feature&#39;)
for i, text in enumerate(my_text):
    plt.scatter(features_2d[i+1, 0], features_2d[i+1, 1], label=f&#39;Text Feature: &#123;text&#125;&#39;)

plt.legend()
plt.title(&quot;PCA of Image and Text Features&quot;)
plt.xlabel(&quot;PCA Component 1&quot;)
plt.ylabel(&quot;PCA Component 2&quot;)
plt.show()
</code></pre></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2025-02-20 20:01:45" itemprop="dateModified" datetime="2025-02-20T20:01:45+08:00">2025-02-20</time> </span><span id="project/基于CLIP的图像物体辨别/" class="item leancloud_visitors" data-flag-title="基于CLIP的图像物体辨别" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.jpg" alt="Runhua Deng 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Runhua Deng alipay"><p>alipay</p></div><div><img data-src="/images/paypal.png" alt="Runhua Deng paypal"><p>paypal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Runhua Deng <i class="ic i-at"><em>@</em></i>枯萎的花将在另一彼岸悄然绽放</li><li class="link"><strong>本文链接：</strong> <a href="https://yunhdan.github.io/project/%E5%9F%BA%E4%BA%8ECLIP%E7%9A%84%E5%9B%BE%E5%83%8F%E7%89%A9%E4%BD%93%E8%BE%A8%E5%88%AB/" title="基于CLIP的图像物体辨别">https://yunhdan.github.io/project/基于CLIP的图像物体辨别/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/other/%E6%88%91%E7%9A%84%E7%A7%91%E7%A0%94%E6%9D%82%E8%B0%88/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2024&#x2F;12&#x2F;04&#x2F;YlBRLtmPTfDx9dz.jpg" title="我的科研杂谈"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 琐碎</span><h3>我的科研杂谈</h3></a></div><div class="item right"><a href="/cs/Javascript%E7%9F%A5%E8%AF%86%E6%A0%91/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2025&#x2F;05&#x2F;18&#x2F;IJYni1hZqOLVjRs.jpg" title="Javascript知识树"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 计算机</span><h3>Javascript知识树</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8ECLIP%E7%9A%84%E5%9B%BE%E5%83%8F%E7%89%A9%E4%BD%93%E8%BE%A8%E5%88%AB"><span class="toc-number">1.</span> <span class="toc-text">基于CLIP的图像物体辨别</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.1.</span> <span class="toc-text">运行环境</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89%E8%BF%9B%E9%98%B6"><span class="toc-number">1.1.0.2.</span> <span class="toc-text">（可选）进阶</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%9B%B8%E5%85%B3%E4%BE%9D%E8%B5%96%E5%8C%85%E4%B8%8ECLIP%E6%BA%90"><span class="toc-number">1.2.</span> <span class="toc-text">安装相关依赖包与CLIP源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81"><span class="toc-number">1.3.</span> <span class="toc-text">核心代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E7%9B%B8%E5%85%B3%E5%8C%85"><span class="toc-number">1.3.1.</span> <span class="toc-text">导入相关包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E5%AE%9A%E6%8E%A8%E7%90%86%E8%BF%90%E7%AE%97%E8%AE%BE%E5%A4%87"><span class="toc-number">1.3.2.</span> <span class="toc-text">规定推理运算设备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">下载模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%9B%BE%E7%89%87"><span class="toc-number">1.3.4.</span> <span class="toc-text">导入图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%9B%BE%E5%83%8F%E7%B1%BB%E5%88%AB%E7%9A%84%E6%96%87%E6%9C%AC%E5%B9%B6%E7%AC%A6%E5%8F%B7%E5%8C%96"><span class="toc-number">1.3.5.</span> <span class="toc-text">定义图像类别的文本并符号化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%9B%BE%E5%83%8F%E4%B8%8E%E6%96%87%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%85%B3%E6%80%A7"><span class="toc-number">1.3.6.</span> <span class="toc-text">计算图像与文本的相关性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E5%88%86%E7%B1%BB%E7%BB%93%E6%9E%9C"><span class="toc-number">1.3.7.</span> <span class="toc-text">打印分类结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81-1"><span class="toc-number">1.3.8.</span> <span class="toc-text">核心代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E6%9E%9C"><span class="toc-number">1.3.9.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A2%E7%B4%A2%E4%BB%A3%E7%A0%81"><span class="toc-number">1.4.</span> <span class="toc-text">探索代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E4%BB%A3%E7%A0%81"><span class="toc-number">1.5.</span> <span class="toc-text">总代码</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/project/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BD%AC%E6%8D%A2%E4%B8%BA%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="bookmark" title="正则表达式转换为自动机">正则表达式转换为自动机</a></li><li><a href="/project/GAN%E7%94%9F%E6%88%90%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E5%AE%9E%E8%B7%B5/" rel="bookmark" title="GAN生成手写数字实践">GAN生成手写数字实践</a></li><li class="active"><a href="/project/%E5%9F%BA%E4%BA%8ECLIP%E7%9A%84%E5%9B%BE%E5%83%8F%E7%89%A9%E4%BD%93%E8%BE%A8%E5%88%AB/" rel="bookmark" title="基于CLIP的图像物体辨别">基于CLIP的图像物体辨别</a></li><li><a href="/project/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%B0%8F%E5%AE%9E%E8%B7%B5%E2%80%94%E2%80%94%E6%9E%84%E5%BB%BAEnv%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E6%B3%95/" rel="bookmark" title="强化学习小实践——构建Env的基本方法">强化学习小实践——构建Env的基本方法</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Runhua Deng" data-src="/images/me.jpg"><p class="name" itemprop="name">Runhua Deng</p><div class="description" itemprop="description">计算机视觉 & 图像恢复</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">44</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">分类</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL1l1bkhEYW4=" title="https:&#x2F;&#x2F;github.com&#x2F;YunHDan"><i class="ic i-github"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTIxMjYzMjE4OTI=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;2126321892"><i class="ic i-cloud-music"></i></span> <a href="/alex2312666252@gmail.com" title="alex2312666252@gmail.com" class="item email"><i class="ic i-envelope"></i></a> <span class="exturl item csdn" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzczNTk5NzM4P3NwbT0xMDAwLjIxMTUuMzAwMS41MzQz" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_73599738?spm&#x3D;1000.2115.3001.5343"><i class="ic i-link"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a><ul class="submenu"><li class="item"><a href="/about/me/" rel="section"><i class="ic i-file"></i>简历</a></li><li class="item"><a href="/about/learn_me/" rel="section"><i class="ic i-smile"></i>了解我</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友達</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/other/%E6%88%91%E7%9A%84%E7%A7%91%E7%A0%94%E6%9D%82%E8%B0%88/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/cs/Javascript%E7%9F%A5%E8%AF%86%E6%A0%91/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/cs/" title="分类于 计算机">计算机</a></div><span><a href="/cs/ACM%E7%AE%97%E6%B3%95%E9%A2%98%E5%8D%95/" title="ACM算法题单">ACM算法题单</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="分类于 人工智能">人工智能</a></div><span><a href="/ai/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%90%86%E8%AE%BA/" title="深度学习理论">深度学习理论</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/cs/" title="分类于 计算机">计算机</a></div><span><a href="/cs/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%90%86%E8%AE%BA1/" title="数据库理论1">数据库理论1</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/cs/" title="分类于 计算机">计算机</a></div><span><a href="/cs/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%90%86%E8%AE%BA2/" title="数据库理论2">数据库理论2</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/cs/" title="分类于 计算机">计算机</a></div><span><a href="/cs/Conda%E3%80%81Pip%E3%80%81Cuda/" title="Conda、Pip、Cuda">Conda、Pip、Cuda</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E5%85%AC%E5%91%8A/" title="公告">公告</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="分类于 人工智能">人工智能</a></div><span><a href="/ai/Deep-Learning-Experiment-Tricks/" title="Deep Learning Experiment Tricks">Deep Learning Experiment Tricks</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/baoyan/" title="分类于 保研">保研</a></div><span><a href="/baoyan/Embodied-3D-Labs/" title="Embodied AI Labs">Embodied AI Labs</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/project/" title="分类于 项目与实践">项目与实践</a></div><span><a href="/project/GAN%E7%94%9F%E6%88%90%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E5%AE%9E%E8%B7%B5/" title="GAN生成手写数字实践">GAN生成手写数字实践</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="分类于 人工智能">人工智能</a></div><span><a href="/ai/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/" title="强化学习">强化学习</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Runhua Deng @ Runfar's Zone</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">196k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">2:58</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"project/基于CLIP的图像物体辨别/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html><!-- rebuild by hrmmi -->